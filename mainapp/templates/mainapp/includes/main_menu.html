<div class="header clearfix">
    <a href="/" class="logo"></a>
    <ul class="menu">
        {% with url_name=request.resolver_match.url_name %}
        {% for link, name in menu.items %}
        <li>
            <a href="{% url link %}" class=
                    {% if url_name == link %} active {% endif %}
                    {% if link == 'products' and url_name == 'category' %} active {% endif %}>
               {{name}}
            </a>
        </li>
        {% endfor %}
        {% endwith %}

        {% if user.is_authenticated %}
                <li>
                    <a href="{% url 'auth:edit' %}">
                        {{ user.first_name|default:'Пользователь' }}
                    </a>
                </li>
        {% endif %}

        {% if user.is_authenticated %}
            <a href="{% url 'auth:logout' %}">
                выйти
            </a>
        {% else %}
            <a href={% url 'auth:login' %}>
                войти
            </a>
            <a href="{% url 'auth:register' %}">
                зарегистрироваться
            </a>
        {% endif %}
        
        {% if user.is_authenticated %}
        <li>
            <a href="{% url 'basket:view' %}">
                <i class='fa fa-shopping-cart'></i>
                <sup>({{request.user.basket.quantity}})</sup>
            </a>
        </li>
        {% endif %}
    </ul>
</div>